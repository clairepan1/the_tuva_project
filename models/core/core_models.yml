version: 2

models:
####  Final

  - name: core__encounter
    description: Core encounter table
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_core
        {% else %}core{%- endif -%}
      alias: encounter
      tags: core
      materialized: table
    columns:
      - name: encounter_id
        description: Unique identifier for an encounter.
      - name: patient_id
        description: Unique identifier for a person across all datasets.
      - name: encounter_type
        description: Type of encounter.
        meta:
          terminology: /terminology/tuva-concepts/encounter-type
      - name: encounter_start_date
        description: Date when the encounter started.
      - name: encounter_end_date
        description: Date when the encounter ended.
      - name: admit_source_code
        description: Admission source code for the encounter.
        meta:
          terminology: /terminology/administrative-codes/admit-source
      - name: admit_source_description
        description: Description of the admit_source_code for the encounter.
      - name: admit_type_code
        description: Admission type code for the encounter.
        meta:
          terminology: /terminology/administrative-codes/admit-type
      - name: admit_type_description
        description: Description of the admit_type_code for the encounter.
      - name: discharge_disposition_code
        description: Discharge disposition code for the encounter.
        meta:
          terminology: /terminology/administrative-codes/discharge-disposition
      - name: discharge_disposition_description
        description: Description of the discharge_disposition_code for the encounter.
      - name: rendering_npi
        description: Rendering NPI for the encounter (typically represents the physician or entity providing services).
        meta:
          terminology: /terminology/providers/provider
      - name: billing_npi
        description: Billing NPI for the encounter (typically represents organization billing the claim).
        meta:
          terminology: /terminology/providers/provider
      - name: facility_npi
        description: Facility NPI for the encounter (typically represents the facility where services were performed).
        meta:
          terminology: /terminology/providers/provider
      - name: ms_drg_code
        description: MS-DRG code for the encounter.
        meta:
          terminology: /terminology/conditions-and-procedures/ms-drg
      - name: ms_drg_description
        description: Description of the ms_drg_code.
      - name: apr_drg_code
        description: APR-DRG code for the encounter.
        meta:
          terminology: /terminology/conditions-and-procedures/ms-drg
      - name: apr_drg_description
        description: Description of the APR-DRG code.
      - name: paid_date
        description: The pay date for the encounter.
      - name: paid_amount
        description: The total amount paid for the encounter by the insurer.
      - name: allowed_amount
        description: The total amount allowed (includes amount paid by the insurer and patient) on the encounter.
      - name: charge_amount
        description: The total amount charged on the encounter by the provider.
      - name: total_cost_amount
        description: The total amount paid on the encounter by different parties.
      - name: data_source
        description: User-configured field that indicates the data source (e.g. typically named after the payer and state "BCBS Tennessee").


  - name: core__patient
    description: Core patient table
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_core
        {% else %}core{%- endif -%}
      alias: patient
      tags: core
      materialized: table
    columns:
      - name: patient_id
        description: Unique identifier for each person across all datasets.
      - name: gender
        description: The gender of the patient.
        meta:
          terminology: /terminology/demographics/gender
      - name: race
        description: The race of the patient.
        meta:
          terminology: /terminology/demographics/race
      - name: birth_date
        description: The birth date of the patient.
      - name: death_date
        description: The death date of the patient if there is one.
      - name: death_flag
        description: A flag indicating if the patient has died.
        data_type: boolean
      - name: first_name
        description: The first name of the patient.
      - name: last_name
        description: The last name of the patient.
      - name: address
        description: The address of the patient.
      - name: city
        description: The city where the patient lives.
      - name: state
        description: The state where the patient lives.
      - name: zip_code
        description: The zip code for the patient.
      - name: phone
        description: The phone number for the patient.
      - name: data_source
        description: User-configured field that indicates the data source (e.g. typically named after the payer and state "BCBS Tennessee").


  - name: core__condition
    description: Core condition table
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_core
        {% else %}core{%- endif -%}
      alias: condition
      tags: core
      materialized: table
    columns:
      - name: encounter_id
        description: Unique encounter_id for each encounter.
      - name: claim_id
        description: Unique claim_id for each claim.
      - name: patient_id
        description: Unique patient_id for each person.
      - name: condition_date
        description: Date in which the condition occured.
      - name: condition_type
        description: The type of condition.
      - name: code_type
        description: The type of condition code.
        meta:
          terminology: /terminology/tuva-concepts/code-type
      - name: code
        description: The condition code.
        meta:
          terminology: /terminology/conditions-and-procedures/icd-10-cm
      - name: description
        description: Description of the condition code.
      - name: diagnosis_rank
        description: The numerical ranking of a diagnosis code in a claim.
        data_type: integer
      - name: present_on_admit_code
        description: The present_on_admit_code related to the condition.
        meta:
          terminology: /terminology/administrative-codes/present-on-admission
      - name: present_on_admit_description
        description: The description of the present_on_admit_code for the condition.
      - name: data_source
        description: User-configured field that indicates the data source (e.g. typically named after the payer and state "BCBS Tennessee").


  - name: core__procedure
    description: Core procedure table
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_core
        {% else %}core{%- endif -%}
      alias: procedure
      tags: core
      materialized: table
    columns:
      - name: encounter_id
        description: The encounter_id for the encounter where this procedure was performed.
      - name: claim_id
        description: The claim on which the procedure was recorded.
      - name: patient_id
        description: Unique identifier for each person across all datasets.
      - name: procedure_date
        description: Date when the procedure was performed.
      - name: code_type
        description: Type of procedure code for the procedure.
        meta:
          terminology: /terminology/tuva-concepts/code-type
      - name: code
        description: The procedure code.
        meta:
          terminology: /terminology/conditions-and-procedures/icd-10-pcs
      - name: description
        description: Description of the procedure code.
      - name: practitioner_npi
        description: NPI of the provider who performed the procedure.
        meta:
          terminology: /terminology/providers/provider
      - name: data_source
        description: User-configured field that indicates the data source (e.g. typically named after the payer and state "BCBS Tennessee").


  - name: core__provider
    description: Core provider table with all providers in the claims dataset
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_core
        {% else %}core{%- endif -%}
      alias: provider
      tags: core
      materialized: table
    columns:
      - name: npi
        description: NPI for the provider.
        meta:
          terminology: /terminology/providers/provider
      - name: entity_type_code
        description: Code that describes the type of provider.
      - name: entity_type_description
        description: Description of the type of provider.
      - name: primary_taxonomy_code
        description: Code corresponding to the primary specialty of the provider.
      - name: primary_specialty_description
        description: Description of the primary specialty for the provider.
      - name: provider_name
        description: Name of the provider.
      - name: parent_organization_name
        description: Name of the parent organization for the provider.
      - name: practice_address_line_1
        description: The first line of the address for the provider.
      - name: practice_address_line_2
        description: The second line of the address for the provider.
      - name: practice_city
        description: The city where the provider is located.
      - name: practice_state
        description: The state where the provider is located.
      - name: practice_zip_code
        description: The zip code for the provider.
      - name: last_updated
        description: Date when the data for this provider was last updated.
      - name: deactivation_date
        description: Date when this NPI was deactivated if there is one.
      - name: deactivation_flag
        description: Flag indicating if this NPI was deactivated.
        data_type: boolean
